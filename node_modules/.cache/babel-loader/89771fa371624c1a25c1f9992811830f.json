{"ast":null,"code":"var _jsxFileName = \"/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/Levantamiento/levantamiento.js\";\nimport React, { Component } from 'react';\nimport { Container, Row, Col, FormGroup, Button, Card, CardBody } from 'reactstrap';\nimport { activateAuthLayout } from '../../store/actions';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { AvForm, AvField } from 'availity-reactstrap-validation';\nimport { getLoggedInUser } from './../../helpers/authUtils';\nimport { getCargos } from './../../helpers/utils';\nimport LevantamientoTable from './../Tables/levantamiento';\nimport { getBienes, getDependencias } from './../../helpers/fetch';\nimport { createProcess } from './../../helpers/httpRequest';\n\nclass Levantamiento extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Bienes: [],\n      Dependencias: [],\n      show: false,\n      user: getLoggedInUser(),\n      BienesSelected: []\n    };\n    this.fetchDependencias = this.fetchDependencias.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleBienes = this.handleBienes.bind(this);\n  }\n\n  async componentDidMount() {\n    this.fetchDependencias();\n    const idSede = Number(this.state.user.dependencia.sede.id);\n\n    try {\n      const result = await getBienes({\n        idSede,\n        fk_usuario: Number(this.state.user.id)\n      }, 4);\n      this.setState({\n        Bienes: result.data.bien,\n        loading: false\n      });\n    } catch (error) {\n      console.log(error);\n      alert('Error en el servidor');\n    }\n  }\n\n  async fetchDependencias() {\n    const result = await getDependencias();\n\n    if (result.data) {\n      this.setState({\n        Dependencias: result.data.dependencia\n      });\n    }\n  }\n\n  handleSubmit(event, values) {\n    let {\n      Bienes\n    } = this.state;\n    let filteredBienes = Bienes.filter(item => Number(item.usuario.dependencia.id) === Number(values.dependencia));\n\n    if (filteredBienes.length === 0) {\n      alert('No hay elementos asociados a esta dependencia');\n      return;\n    } else this.setState({\n      Bienes: filteredBienes,\n      show: true\n    });\n  }\n\n  async handleBienes(data) {\n    this.setState({\n      BienesSelected: data\n    });\n  }\n\n  async submitLevantamiento() {\n    const {\n      BienesSelected,\n      user\n    } = this.state;\n    let BienesId = [];\n    let cambios = [];\n    BienesSelected.map(async item => {\n      BienesId.push(item.id);\n      cambios.push({\n        id: item.id,\n        fk_usuario: user.id,\n        fk_estado: 1,\n        estado_bien: item.estadoBien ? item.estadoBien : 'En buen estado',\n        verificacion: item.verificacion ? item.verificacion : 'Verificado'\n      });\n    });\n    const data = {\n      descripcion: \"Levantamiento de bienes\",\n      razon: \"Usuario pidio realizar un levantamiento de bienes\",\n      contratista: \"contratista\",\n      bienes: BienesId,\n      fk_usuario: user.id,\n      cambios: {\n        bienes: cambios\n      },\n      fk_tipo_solicitud: 2\n    };\n\n    try {\n      await createProcess(data);\n      alert('Levantamiento realizado correctamente');\n      this.props.history.push('/');\n    } catch (error) {\n      alert('Error en el servidor');\n    }\n  }\n\n  render() {\n    const {\n      Bienes,\n      show,\n      user,\n      Dependencias\n    } = this.state;\n    const idRol = Number(user.auth.rol.id);\n    const idDependencia = Number(user.dependencia.id);\n    return (\n      /*#__PURE__*/\n      React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Container, {\n        fluid: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        className: \"page-title-box\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        className: \"align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h3\", {\n        className: \"page-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 33\n        }\n      }, \"LEVANTAMIENTO\")))),\n      /*#__PURE__*/\n      React.createElement(Card, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(CardBody, {\n        className: \"form-comprobante\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 44\n        }\n      }, \"Identificaci\\xF3n: \"), \" \", user.id)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 44\n        }\n      }, \"Funcionario: \"), \" \", user.nombres, \" \", user.apellidos)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 44\n        }\n      }, \"Correo: \"), \" \", user.correo)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 44\n        }\n      }, \"Cargo: \"), \" \", getCargos(user.cargos)))),\n      /*#__PURE__*/\n      React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 33\n        }\n      }),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h5\", {\n        className: \"page-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 37\n        }\n      }, \"Busqueda por dependencia\")),\n      /*#__PURE__*/\n      React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 33\n        }\n      }),\n      /*#__PURE__*/\n      React.createElement(AvForm, {\n        className: \"form\",\n        onValidSubmit: this.handleSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(FormGroup, {\n        style: {\n          marginBottom: '15px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(AvField, {\n        label: \"Dependencia\",\n        value: idDependencia,\n        name: \"dependencia\",\n        type: \"select\",\n        grid: {\n          xs: 8\n        },\n        validate: {\n          required: {\n            value: true,\n            errorMessage: 'Campo requerido'\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 49\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        disabled: true,\n        value: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 53\n        }\n      }, \"Seleccione una dependencia\"), Dependencias.length === 0 ?\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 57\n        }\n      }) : Dependencias.map(({\n        id,\n        dependencia\n      }) =>\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        value: id,\n        key: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 61\n        }\n      }, dependencia)))),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        className: \"btn btn-primary\",\n        style: {\n          marginLeft: '8px'\n        },\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 49\n        }\n      }, \"Buscar\")))))),\n      /*#__PURE__*/\n      React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 29\n        }\n      }),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 29\n        }\n      }, !show ? '' :\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(LevantamientoTable, {\n        idRol: idRol,\n        Bienes: Bienes,\n        callback: this.handleBienes,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 45\n        }\n      }),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        className: \"form-group m-t-20\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        md: \"12\",\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 49\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        color: \"primary\",\n        className: \"w-md waves-effect waves-light\",\n        onClick: this.submitLevantamiento.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 53\n        }\n      }, \"Realizar Traslado\")))))))))\n    );\n  }\n\n}\n\nexport default withRouter(connect(null, {\n  activateAuthLayout\n})(Levantamiento));","map":{"version":3,"sources":["/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/Levantamiento/levantamiento.js"],"names":["React","Component","Container","Row","Col","FormGroup","Button","Card","CardBody","activateAuthLayout","withRouter","connect","AvForm","AvField","getLoggedInUser","getCargos","LevantamientoTable","getBienes","getDependencias","createProcess","Levantamiento","constructor","props","state","Bienes","Dependencias","show","user","BienesSelected","fetchDependencias","bind","handleSubmit","handleBienes","componentDidMount","idSede","Number","dependencia","sede","id","result","fk_usuario","setState","data","bien","loading","error","console","log","alert","event","values","filteredBienes","filter","item","usuario","length","submitLevantamiento","BienesId","cambios","map","push","fk_estado","estado_bien","estadoBien","verificacion","descripcion","razon","contratista","bienes","fk_tipo_solicitud","history","render","idRol","auth","rol","idDependencia","fontWeight","nombres","apellidos","correo","cargos","marginBottom","xs","required","value","errorMessage","marginLeft"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Container, Row, Col, FormGroup, Button, Card, CardBody } from 'reactstrap';\nimport { activateAuthLayout } from '../../store/actions';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { AvForm, AvField } from 'availity-reactstrap-validation';\nimport { getLoggedInUser } from './../../helpers/authUtils'\nimport { getCargos } from './../../helpers/utils'\nimport LevantamientoTable from './../Tables/levantamiento';\nimport { getBienes, getDependencias } from './../../helpers/fetch';\nimport { createProcess } from './../../helpers/httpRequest'\n\nclass Levantamiento extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            Bienes: [],\n            Dependencias: [],\n            show: false,\n            user: getLoggedInUser(),\n            BienesSelected: []\n        };\n        this.fetchDependencias = this.fetchDependencias.bind(this)\n        this.handleSubmit = this.handleSubmit.bind(this)\n        this.handleBienes = this.handleBienes.bind(this)\n    }\n\n    async componentDidMount() {\n        this.fetchDependencias()\n        const idSede = Number(this.state.user.dependencia.sede.id)\n        try {\n            const result = await getBienes({idSede, fk_usuario: Number(this.state.user.id)}, 4)\n            this.setState({ Bienes: result.data.bien, loading: false })\n        } catch (error) {\n            console.log(error);\n            alert('Error en el servidor')\n        }\n    }\n\n    async fetchDependencias() {\n        const result = await getDependencias()\n        if (result.data) {\n            this.setState({ Dependencias: result.data.dependencia })\n        }\n    }\n\n    handleSubmit(event, values) {\n        let { Bienes } = this.state\n        \n        let filteredBienes = Bienes.filter(\n            item => Number(item.usuario.dependencia.id) === Number(values.dependencia)\n        )\n\n        if (filteredBienes.length === 0) {\n            alert('No hay elementos asociados a esta dependencia')\n            return;\n        }\n        else\n            this.setState({ Bienes: filteredBienes, show: true })\n    }\n\n    async handleBienes(data) {\n        this.setState({ BienesSelected: data })\n    }\n\n    async submitLevantamiento() {\n        const { BienesSelected, user } = this.state\n        let BienesId = []\n        let cambios = []\n        BienesSelected.map(async item => {\n            BienesId.push(item.id)\n            cambios.push({\n                id: item.id,\n                fk_usuario: user.id,\n                fk_estado: 1,\n                estado_bien: item.estadoBien ? item.estadoBien : 'En buen estado',\n                verificacion: item.verificacion ? item.verificacion : 'Verificado'\n            })\n        })\n        const data = {\n            descripcion: \"Levantamiento de bienes\",\n            razon: \"Usuario pidio realizar un levantamiento de bienes\",\n            contratista: \"contratista\",\n            bienes: BienesId,\n            fk_usuario: user.id,\n            cambios: {\n                bienes: cambios\n            },\n            fk_tipo_solicitud: 2\n        }\n        try {\n            await createProcess(data)\n            alert('Levantamiento realizado correctamente')\n            this.props.history.push('/')\n        } catch (error) {\n            alert('Error en el servidor')\n        }\n    }\n\n    render() {\n        const { Bienes, show, user, Dependencias } = this.state;\n        const idRol = Number(user.auth.rol.id)\n        const idDependencia = Number(user.dependencia.id)\n        return (\n            <React.Fragment>\n                <Container fluid>\n                    <div className=\"page-title-box\">\n                        <Row className=\"align-items-center\">\n                            <Col sm=\"12\">\n                                <h3 className=\"page-title\">LEVANTAMIENTO</h3>\n                            </Col>\n                        </Row>\n                    </div>\n                    <Card>\n                        <CardBody className=\"form-comprobante\">\n                            <div>\n                                <Row>\n                                    <Col sm='3'>\n                                        <p><span style={{ fontWeight: 'bold' }}>Identificaci&oacute;n: </span> {user.id}</p>\n                                    </Col>\n                                    <Col sm='3'>\n                                        <p><span style={{ fontWeight: 'bold' }}>Funcionario: </span> {user.nombres} {user.apellidos}</p>\n                                    </Col>\n                                    <Col sm='3'>\n                                        <p><span style={{ fontWeight: 'bold' }}>Correo: </span> {user.correo}</p>\n                                    </Col>\n                                    <Col sm='3'>\n                                        <p><span style={{ fontWeight: 'bold' }}>Cargo: </span> {getCargos(user.cargos)}</p>\n                                    </Col>\n                                </Row>\n                                <hr></hr>\n                                <Row>\n                                    <h5 className=\"page-title\">Busqueda por dependencia</h5>\n                                </Row>\n                                <br></br>\n                                <AvForm className=\"form\" onValidSubmit={this.handleSubmit} >\n                                    <FormGroup style={{ marginBottom: '15px' }}>\n                                        <Row>\n                                            <Col sm=\"6\">\n                                                <AvField label=\"Dependencia\" value={idDependencia} name=\"dependencia\" type='select' grid={{ xs: 8 }} validate={{\n                                                    required: { value: true, errorMessage: 'Campo requerido' }\n                                                }}>\n                                                    <option disabled value=\"\">Seleccione una dependencia</option>\n                                                    {Dependencias.length === 0 ?\n                                                        <option></option>\n                                                        :\n                                                        Dependencias.map(({ id, dependencia }) =>\n                                                            <option value={id} key={id}>{dependencia}</option>\n                                                        )}\n                                                </AvField>\n                                            </Col>\n                                            <Col sm=\"6\">\n                                                <Button className=\"btn btn-primary\" style={{ marginLeft: '8px' }} type=\"submit\">Buscar</Button>\n                                            </Col>\n                                        </Row>\n                                    </FormGroup>\n                                </AvForm>\n                            </div>\n                            <hr></hr>\n                            <Row>\n                                {\n                                    !show ? '' :\n                                        <div>\n                                            <LevantamientoTable idRol={idRol} Bienes={Bienes} callback={this.handleBienes}></LevantamientoTable>\n                                            <Row className=\"form-group m-t-20\">\n                                                <Col md=\"12\" className=\"text-right\">\n                                                    <Button color=\"primary\" className=\"w-md waves-effect waves-light\" onClick={this.submitLevantamiento.bind(this)}>Realizar Traslado</Button>\n                                                </Col>\n                                            </Row>\n                                        </div>\n                                }\n                            </Row>\n                        </CardBody>\n                    </Card>\n                </Container>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default withRouter(connect(null, { activateAuthLayout })(Levantamiento));"]},"metadata":{},"sourceType":"module"}