{"ast":null,"code":"var _jsxFileName = \"/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/Bienes/altaBien.js\";\nimport React, { Component } from 'react';\nimport { Container, Row, Col, Card, CardBody, Button, Spinner, Modal, ModalFooter } from 'reactstrap';\nimport { activateAuthLayout } from '../../store/actions';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { getBienes, updateBienState } from '../../helpers/fetch';\nimport { getLoggedInUser } from '../../helpers/authUtils';\nimport BajaBienTable from '../Tables/bajaBienTable';\nimport { createProcess } from './../../helpers/httpRequest';\n\nclass AltaBien extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      user: getLoggedInUser(),\n      Bienes: []\n    };\n    this.submitAltaBien = this.submitAltaBien.bind(this);\n    this.toggleModal = this.toggleModal.bind(this);\n    this.handleSubmitForm = this.handleSubmitForm.bind(this);\n    this.getBienesCheck = this.getBienesCheck.bind(this);\n  }\n\n  async componentDidMount() {\n    const {\n      user\n    } = this.state;\n\n    try {\n      const idRol = Number(user.auth.rol.id);\n      const idSede = Number(this.state.user.dependencia.sede.id);\n      let res;\n      if (idRol === 4) res = await getBienes({\n        idSede,\n        fk_usuario: user.id\n      }, 6);else res = await getBienes({\n        idSede\n      }, 3);\n      const result = res;\n\n      if (result.data.bien.length === 0) {\n        alert('No hay bienes para realizar un alta de bien');\n        this.props.history.push('/');\n      } else this.setState({\n        Bienes: result.data.bien,\n        loading: true\n      });\n    } catch (error) {\n      console.log(error);\n      alert('Error en el servidor');\n    }\n  }\n\n  toggleModal() {\n    this.setState(prevState => ({\n      modal: !prevState.modal\n    }));\n  }\n\n  async getBienesCheck(data) {\n    this.setState({\n      BienesSelected: data\n    });\n  }\n\n  async handleSubmitForm() {\n    await this.setState({\n      modal: true\n    });\n  }\n\n  async submitAltaBien() {\n    const {\n      BienesSelected,\n      user\n    } = this.state;\n\n    try {\n      const BienesId = [];\n      const cambios = [];\n      BienesSelected.map(async item => {\n        BienesId.push(item.id);\n        cambios.push({\n          id: item.id,\n          fk_estado: 1\n        });\n        await updateBienState({\n          id: item.id\n        });\n      });\n      const data = {\n        descripcion: \"Dar de baja\",\n        razon: \"Usuario pidio realizar un alta del bien\",\n        contratista: \"contratista\",\n        bienes: BienesId,\n        fk_usuario: user.id,\n        cambios: {\n          bienes: cambios\n        },\n        fk_tipo_solicitud: 7\n      };\n      await createProcess(data);\n      this.setState({\n        modal: false\n      });\n      alert('Proceso de alta de bien creado correcto');\n      this.props.history.push('/');\n    } catch (error) {\n      alert('Error en el servidor');\n    }\n  }\n\n  render() {\n    const {\n      user,\n      loading,\n      Bienes\n    } = this.state;\n    return (\n      /*#__PURE__*/\n      React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Container, {\n        fluid: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        className: \"page-title-box\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        className: \"align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h4\", {\n        className: \"page-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 33\n        }\n      }, \"ALTA DE BIEN\")))),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Card, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(CardBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        className: \"subtitulo-form\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 45\n        }\n      }, \"Qui\\xE9n Entrega \"))),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 48\n        }\n      }, \"Identificaci\\xF3n: \"), \" \", user.id)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 48\n        }\n      }, \"Funcionario: \"), \" \", user.nombres, \" \", user.apellidos)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 48\n        }\n      }, \"Correo: \"), \" \", user.correo)),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 41\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 45\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 48\n        }\n      }, \"Cargo: \"), \" \", user.cargos[0].cargo))),\n      /*#__PURE__*/\n      React.createElement(\"hr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 37\n        }\n      }), !loading ?\n      /*#__PURE__*/\n      React.createElement(Spinner, {\n        color: \"info\",\n        style: {\n          width: '3rem',\n          height: '3rem',\n          marginLeft: '45%',\n          margingRight: '45%'\n        },\n        type: \"grow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 41\n        }\n      }) :\n      /*#__PURE__*/\n      React.createElement(BajaBienTable, {\n        Bienes: Bienes,\n        callback: this.getBienesCheck,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 41\n        }\n      }), !loading ? '' : Bienes.length === 0 ? '' :\n      /*#__PURE__*/\n      React.createElement(Row, {\n        className: \"form-group m-t-20\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 49\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        md: \"12\",\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 53\n        }\n      }, !loading ?\n      /*#__PURE__*/\n      React.createElement(Button, {\n        color: \"primary\",\n        className: \"w-md waves-effect waves-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 70\n        }\n      }, \"Cargando ...\") :\n      /*#__PURE__*/\n      React.createElement(Button, {\n        color: \"primary\",\n        className: \"w-md waves-effect waves-light\",\n        onClick: this.handleSubmitForm,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 61\n        }\n      }, \"Dar baja de bien\"))))))),\n      /*#__PURE__*/\n      React.createElement(Modal, {\n        isOpen: this.state.modal,\n        toggle: this.toggleModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        className: \"modal-header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h5\", {\n        className: \"modal-title mt-0\",\n        id: \"confirmacion\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 29\n        }\n      }, \"\\xBFEstas seguro de realizar esta acci\\xF3n?\"),\n      /*#__PURE__*/\n      React.createElement(\"button\", {\n        type: \"button\",\n        onClick: () => this.setState({\n          modal: false\n        }),\n        className: \"close\",\n        \"data-dismiss\": \"modal\",\n        \"aria-label\": \"Close\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        \"aria-hidden\": \"true\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 33\n        }\n      }, \"\\xD7\"))),\n      /*#__PURE__*/\n      React.createElement(ModalFooter, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        type: \"button\",\n        color: \"secondary\",\n        onClick: () => this.setState({\n          modal: false\n        }),\n        className: \"waves-effect\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 29\n        }\n      }, \"Close\"),\n      /*#__PURE__*/\n      React.createElement(Button, {\n        type: \"button\",\n        color: \"primary\",\n        className: \"waves-effect waves-light\",\n        onClick: this.submitAltaBien,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 29\n        }\n      }, \"Confimar\")))))\n    );\n  }\n\n}\n\nexport default withRouter(connect(null, {\n  activateAuthLayout\n})(AltaBien));","map":{"version":3,"sources":["/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/Bienes/altaBien.js"],"names":["React","Component","Container","Row","Col","Card","CardBody","Button","Spinner","Modal","ModalFooter","activateAuthLayout","withRouter","connect","getBienes","updateBienState","getLoggedInUser","BajaBienTable","createProcess","AltaBien","constructor","props","state","loading","user","Bienes","submitAltaBien","bind","toggleModal","handleSubmitForm","getBienesCheck","componentDidMount","idRol","Number","auth","rol","id","idSede","dependencia","sede","res","fk_usuario","result","data","bien","length","alert","history","push","setState","error","console","log","prevState","modal","BienesSelected","BienesId","cambios","map","item","fk_estado","descripcion","razon","contratista","bienes","fk_tipo_solicitud","render","fontWeight","nombres","apellidos","correo","cargos","cargo","width","height","marginLeft","margingRight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Container, Row, Col, Card, CardBody, Button, Spinner, Modal, ModalFooter } from 'reactstrap';\nimport { activateAuthLayout } from '../../store/actions';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { getBienes, updateBienState } from '../../helpers/fetch'\nimport { getLoggedInUser } from '../../helpers/authUtils'\nimport BajaBienTable from '../Tables/bajaBienTable';\nimport { createProcess } from './../../helpers/httpRequest'\n\nclass AltaBien extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            loading: false,\n            user: getLoggedInUser(),\n            Bienes: []\n        };\n\n        this.submitAltaBien = this.submitAltaBien.bind(this)\n        this.toggleModal = this.toggleModal.bind(this)\n        this.handleSubmitForm = this.handleSubmitForm.bind(this)\n        this.getBienesCheck = this.getBienesCheck.bind(this)\n    }\n\n    async componentDidMount() {\n        const { user } = this.state\n        try {\n            const idRol = Number(user.auth.rol.id)\n            const idSede = Number(this.state.user.dependencia.sede.id)\n            let res \n            if(idRol === 4) \n                res = await getBienes({idSede, fk_usuario: user.id }, 6)\n            else \n                res = await getBienes({idSede}, 3)\n            \n            const result = res\n            if(result.data.bien.length === 0) {\n                alert('No hay bienes para realizar un alta de bien')\n                this.props.history.push('/')\n            }\n            else\n                this.setState({ Bienes: result.data.bien, loading: true})\n        } catch (error) { \n            console.log(error);\n            alert('Error en el servidor')\n        }\n    }\n    \n    toggleModal() {\n        this.setState(prevState => ({\n            modal: !prevState.modal\n        }));\n    }\n\n    async getBienesCheck(data) {\n        this.setState({ BienesSelected: data})\n    }\n\n    async handleSubmitForm() {\n        await this.setState({ modal: true})\n    }\n\n    async submitAltaBien() {\n        const { BienesSelected, user } = this.state;\n        try {\n            const BienesId = []\n            const cambios = []\n            BienesSelected.map( async item => {\n                BienesId.push(item.id)\n                cambios.push({ id: item.id, fk_estado: 1})\n                await updateBienState({ id: item.id})\n            })\n            const data = {\n                descripcion: \"Dar de baja\",\n                razon: \"Usuario pidio realizar un alta del bien\",\n                contratista: \"contratista\",\n                bienes: BienesId,\n                fk_usuario: user.id,\n                cambios: {\n                    bienes: cambios\n                },\n                fk_tipo_solicitud: 7\n            }\n            await createProcess(data)\n            this.setState({ modal: false })\n            alert('Proceso de alta de bien creado correcto')\n            this.props.history.push('/');\n        } catch (error) {\n            alert('Error en el servidor')\n        }\n    }\n\n    render() {\n        const { user, loading, Bienes } = this.state;\n        return (\n            <React.Fragment>\n                <Container fluid>\n                    <div className=\"page-title-box\">\n                        <Row className=\"align-items-center\">\n                            <Col sm=\"12\">\n                                <h4 className=\"page-title\">ALTA DE BIEN</h4>\n                            </Col>\n                        </Row>\n                    </div>\n                    <Row>\n                        <Col>\n                            <Card>\n                                <CardBody>\n                                    <Row>\n                                        <Col sm='4' className=\"subtitulo-form\">\n                                            <h5>Qui&eacute;n Entrega </h5>\n                                        </Col>\n                                    </Row>\n                                    <Row>\n                                        <Col sm='3'>\n                                            <p><span style={{ fontWeight: 'bold' }}>Identificaci&oacute;n: </span> {user.id}</p>\n                                        </Col>\n                                        <Col sm='3'>\n                                            <p><span style={{ fontWeight: 'bold' }}>Funcionario: </span> {user.nombres} {user.apellidos}</p>\n                                        </Col>\n                                        <Col sm='3'>\n                                            <p><span style={{ fontWeight: 'bold' }}>Correo: </span> {user.correo}</p>\n                                        </Col>\n                                        <Col sm='3'>\n                                            <p><span style={{ fontWeight: 'bold' }}>Cargo: </span> {user.cargos[0].cargo}</p>\n                                        </Col>\n                                    </Row>\n                                    <hr></hr>\n                                    {   !loading ?\n                                        <Spinner color=\"info\" style={{ width: '3rem', height: '3rem', marginLeft: '45%', margingRight: '45%' }} type=\"grow\" /> :\n                                        <BajaBienTable Bienes={Bienes} callback={this.getBienesCheck}></BajaBienTable>\n                                    } \n                                    {\n                                        !loading ? '' :\n                                            Bienes.length === 0 ? '' :\n                                                <Row className=\"form-group m-t-20\">\n                                                    <Col md=\"12\" className=\"text-right\">\n                                                        { !loading ? <Button color=\"primary\" className=\"w-md waves-effect waves-light\">Cargando ...</Button> :\n                                                            <Button color=\"primary\" className=\"w-md waves-effect waves-light\" onClick={this.handleSubmitForm}>Dar baja de bien</Button>}\n                                                    </Col>\n                                                </Row>\n                                    }\n                                </CardBody>\n                            </Card>\n                        </Col>\n                    </Row>\n                    <Modal isOpen={this.state.modal} toggle={this.toggleModal} >\n                        <div className=\"modal-header\">\n                            <h5 className=\"modal-title mt-0\" id=\"confirmacion\">¿Estas seguro de realizar esta acción?</h5>\n                            <button type=\"button\" onClick={() => this.setState({ modal: false })} className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                <span aria-hidden=\"true\">&times;</span>\n                            </button>\n                        </div>\n                        <ModalFooter>\n                            <Button type=\"button\" color=\"secondary\" onClick={ () => this.setState({ modal: false})} className=\"waves-effect\">Close</Button>\n                            <Button type=\"button\" color=\"primary\" className=\"waves-effect waves-light\" onClick={this.submitAltaBien}>Confimar</Button>\n                        </ModalFooter>\n                    </Modal>\n                </Container>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default withRouter(connect(null, { activateAuthLayout })(AltaBien));"]},"metadata":{},"sourceType":"module"}