{"ast":null,"code":"var _jsxFileName = \"/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/UIElements/addDependencia.js\";\nimport React, { Component } from 'react';\nimport { Button, Row, Col, Modal, ModalFooter } from 'reactstrap';\nimport { AvForm, AvField } from 'availity-reactstrap-validation';\nimport { getUsuarioById, createDependencia, createDependenciaUser } from './../../helpers/fetch';\nimport { getCargos } from './../../helpers/utils';\n\nclass AddDependencia extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = e => {\n      this.setState({\n        idResponsable: e.target.value\n      });\n    };\n\n    this.state = {\n      modal: false,\n      confirmation: false,\n      values: null,\n      user: props.user,\n      show: false\n    };\n    this.toggleModal = this.toggleModal.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.submitId = this.submitId.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.submitDependencia = this.submitDependencia.bind(this);\n  }\n\n  handleSubmit(event, values) {\n    this.setState({\n      modal: true,\n      values,\n      searchUser: null,\n      show: false\n    });\n  }\n\n  async submitId() {\n    try {\n      const result = await getUsuarioById({\n        id: this.state.idResponsable\n      });\n      const usuario = result.data.usuario;\n      if (usuario.length === 0) alert('No existe este usuario');else this.setState({\n        show: true,\n        searchUser: usuario[0]\n      });\n    } catch (error) {\n      alert('Error en el servidor');\n    }\n  }\n\n  async submitDependencia() {\n    const {\n      values,\n      idResponsable\n    } = this.state;\n\n    try {\n      const data = {\n        dependencia: values.dependencia,\n        fk_sede: values.sede\n      };\n      const result = await createDependencia(data);\n      await createDependenciaUser({\n        fk_usuario: Number(idResponsable),\n        fk_dependencia: result.data.insert_dependencia.returning[0].id\n      });\n      this.setState({\n        modal: false,\n        idResponsable: ''\n      });\n      alert('Dependencia creada exitosamente');\n    } catch (error) {\n      alert('Error en el servidor');\n    }\n\n    this.form && this.form.reset();\n  }\n\n  toggleModal() {\n    this.setState(prevState => ({\n      modal: !prevState.modal\n    }));\n  }\n\n  render() {\n    const {\n      show,\n      searchUser\n    } = this.state;\n    const errorMessage = 'Campo requerido';\n    return (\n      /*#__PURE__*/\n      React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 25\n        }\n      }, \"Crear dependencia\"))),\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(AvForm, {\n        className: \"form-horizontal\",\n        onValidSubmit: this.submitId,\n        ref: c => this.form = c,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"9\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(AvField, {\n        label: \"Responsable\",\n        disabled: show,\n        onChange: this.handleChange,\n        value: this.state.idResponsable,\n        placeholder: \"Ingrese el ID del responsable\",\n        name: \"responsable\",\n        type: \"text\",\n        grid: {\n          xs: 7\n        },\n        validate: {\n          required: {\n            value: true,\n            errorMessage: errorMessage\n          },\n          pattern: {\n            value: '^[0-9]+$',\n            errorMessage: 'Solo valores númericos'\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 37\n        }\n      })),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        className: \"btn btn-primary\",\n        style: {\n          marginLeft: '8px'\n        },\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 37\n        }\n      }, \"Buscar\"))))), !show ? '' :\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"8\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 40\n        }\n      }, \"Funcionario:\"), \" \", searchUser.nombres, \" \", searchUser.apellidos, \" \")),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 40\n        }\n      }, \"Correo:\"), searchUser.correo, \" \")),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 33\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 37\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        style: {\n          fontWeight: 'bold'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 40\n        }\n      }, \"Cargo:\"), getCargos(searchUser.cargos)))))),\n      /*#__PURE__*/\n      React.createElement(AvForm, {\n        className: \"form-horizontal\",\n        onValidSubmit: this.handleSubmit,\n        ref: c => this.form = c,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(AvField, {\n        id: \"selectSede\",\n        label: \"Sede\",\n        name: \"sede\",\n        type: \"select\",\n        value: this.props.sede,\n        grid: {\n          xs: 8\n        },\n        validate: {\n          required: {\n            value: true,\n            errorMessage: errorMessage\n          }\n        },\n        disabled: !show,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        disabled: true,\n        value: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 29\n        }\n      }, \"Seleccione una sede\"), this.props.sedes.length === 0 ?\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 33\n        }\n      }) : this.props.sedes.map(({\n        id,\n        sede\n      }) =>\n      /*#__PURE__*/\n      React.createElement(\"option\", {\n        value: id,\n        key: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 33\n        }\n      }, sede)))),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(AvField, {\n        label: \"Nombre dependencia\",\n        disabled: !show,\n        placeholder: \"Ingrese la dependencia\",\n        name: \"dependencia\",\n        type: \"text\",\n        grid: {\n          xs: 7\n        },\n        validate: {\n          required: {\n            value: true,\n            errorMessage: errorMessage\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 29\n        }\n      })),\n      /*#__PURE__*/\n      React.createElement(Col, {\n        sm: \"2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        className: \"btn btn-primary\",\n        style: {\n          marginLeft: '8px'\n        },\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 29\n        }\n      }, \"Crear\")))),\n      /*#__PURE__*/\n      React.createElement(Modal, {\n        isOpen: this.state.modal,\n        toggle: this.toggleModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"div\", {\n        className: \"modal-header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"h5\", {\n        className: \"modal-title mt-0\",\n        id: \"confirmacion\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }\n      }, \"\\xBFEstas seguro de realizar esta acci\\xF3n?\"),\n      /*#__PURE__*/\n      React.createElement(\"button\", {\n        type: \"button\",\n        onClick: () => this.setState({\n          modal: false\n        }),\n        className: \"close\",\n        \"data-dismiss\": \"modal\",\n        \"aria-label\": \"Close\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(\"span\", {\n        \"aria-hidden\": \"true\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 29\n        }\n      }, \"\\xD7\"))),\n      /*#__PURE__*/\n      React.createElement(ModalFooter, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }\n      },\n      /*#__PURE__*/\n      React.createElement(Button, {\n        type: \"button\",\n        color: \"secondary\",\n        onClick: () => this.setState({\n          modal: false\n        }),\n        className: \"waves-effect\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 25\n        }\n      }, \"Close\"),\n      /*#__PURE__*/\n      React.createElement(Button, {\n        type: \"button\",\n        color: \"primary\",\n        className: \"waves-effect waves-light\",\n        onClick: this.submitDependencia,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 25\n        }\n      }, \"Confimar\"))))\n    );\n  }\n\n}\n\nexport default AddDependencia;","map":{"version":3,"sources":["/home/jorg/Downloads/REPOSITORIOS UD/proyecto_frontend_v0.7.0/gestion_inventarios_frontend-develop/src/pages/UIElements/addDependencia.js"],"names":["React","Component","Button","Row","Col","Modal","ModalFooter","AvForm","AvField","getUsuarioById","createDependencia","createDependenciaUser","getCargos","AddDependencia","constructor","props","handleChange","e","setState","idResponsable","target","value","state","modal","confirmation","values","user","show","toggleModal","bind","handleSubmit","submitId","submitDependencia","event","searchUser","result","id","usuario","data","length","alert","error","dependencia","fk_sede","sede","fk_usuario","Number","fk_dependencia","insert_dependencia","returning","form","reset","prevState","render","errorMessage","c","xs","required","pattern","marginLeft","fontWeight","nombres","apellidos","correo","cargos","sedes","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, Row, Col, Modal, ModalFooter } from 'reactstrap';\nimport { AvForm, AvField } from 'availity-reactstrap-validation';\nimport { getUsuarioById, createDependencia, createDependenciaUser } from './../../helpers/fetch'\nimport { getCargos } from './../../helpers/utils'\n\nclass AddDependencia extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            modal: false,\n            confirmation: false,\n            values: null,\n            user: props.user,\n            show: false\n        };\n        this.toggleModal = this.toggleModal.bind(this)\n        this.handleSubmit = this.handleSubmit.bind(this)\n        this.submitId = this.submitId.bind(this)\n        this.handleChange = this.handleChange.bind(this)\n        this.submitDependencia = this.submitDependencia.bind(this)\n    }\n\n    handleSubmit(event, values) {\n        this.setState({\n            modal: true,\n            values,\n            searchUser: null,\n            show: false,\n        })\n    }\n\n    async submitId() {\n        try {\n            const result = await getUsuarioById({ id: this.state.idResponsable })\n            const usuario = result.data.usuario\n            if (usuario.length === 0)\n                alert('No existe este usuario')\n            else\n                this.setState({\n                    show: true,\n                    searchUser: usuario[0]\n                })\n        } catch (error) {\n            alert('Error en el servidor')\n        }\n    }\n\n    handleChange = e => {\n        this.setState({ idResponsable: e.target.value });\n    };\n\n    async submitDependencia() {\n        const { values, idResponsable } = this.state\n        try {\n            const data = {\n                dependencia: values.dependencia,\n                fk_sede: values.sede\n            }\n            const result = await createDependencia(data)\n            await createDependenciaUser({ fk_usuario: Number(idResponsable), fk_dependencia: result.data.insert_dependencia.returning[0].id })\n            this.setState({ modal: false, idResponsable:'' })\n            alert('Dependencia creada exitosamente')\n\n        } catch (error) {\n            alert('Error en el servidor')\n        }\n        this.form && this.form.reset();\n    }\n\n\n    toggleModal() {\n        this.setState(prevState => ({\n            modal: !prevState.modal\n        }));\n    }\n\n    render() {\n        const { show, searchUser } = this.state\n        const errorMessage = 'Campo requerido'\n        return (\n            <React.Fragment>\n                <Row>\n                    <Col sm=\"12\">\n                        <h5>Crear dependencia</h5>\n                    </Col>\n                </Row>\n                <Row>\n                    <Col sm='4'>\n                        <AvForm className=\"form-horizontal\" onValidSubmit={this.submitId} ref={c => (this.form = c)}>\n                            <Row>\n                                <Col sm='9'>\n                                    <AvField label=\"Responsable\" disabled={show} onChange={this.handleChange} value={this.state.idResponsable} placeholder=\"Ingrese el ID del responsable\"\n                                        name=\"responsable\" type=\"text\" grid={{ xs: 7 }} validate={{\n                                        required: { value: true, errorMessage: errorMessage },\n                                        pattern: { value: '^[0-9]+$', errorMessage: 'Solo valores númericos' },\n                                    }} />\n                                </Col>\n                                <Col sm='2'>\n                                    <Button className=\"btn btn-primary\" style={{ marginLeft: '8px' }} type=\"submit\">Buscar</Button>\n                                </Col>\n                            </Row>\n                        </AvForm>\n                    </Col>\n                    {\n                        !show ? '' :\n                        <Col sm='8'>\n                            <Row>\n                                <Col sm='4'>\n                                    <p><span style={{ fontWeight: 'bold' }}>Funcionario:</span> {searchUser.nombres} {searchUser.apellidos} </p>\n                                </Col>\n                                <Col sm='4'>\n                                    <p><span style={{ fontWeight: 'bold' }}>Correo:</span>{searchUser.correo} </p>\n                                </Col>\n                                <Col sm='4'>\n                                    <p><span style={{ fontWeight: 'bold' }}>Cargo:</span>{getCargos(searchUser.cargos)}</p>\n                                </Col>\n                            </Row>\n                        </Col>\n                    }\n                </Row>\n                <AvForm className=\"form-horizontal\" onValidSubmit={this.handleSubmit} ref={c => (this.form = c)}>\n                    <Row>\n                        <Col sm='4'>\n                            <AvField id=\"selectSede\" label=\"Sede\" name=\"sede\" type='select' value={this.props.sede} grid={{ xs: 8 }} validate={{\n                                required: { value: true, errorMessage: errorMessage }\n                            }} disabled={!show}>\n                            <option disabled value=\"\">Seleccione una sede</option>\n                            {   this.props.sedes.length === 0 ?\n                                <option></option>\n                                :\n                                this.props.sedes.map(({ id, sede }) =>\n                                <option value={id} key={id}>{sede}</option>\n                            )}\n                            </AvField>\n                        </Col>                            \n                        <Col sm='4'>\n                            <AvField label=\"Nombre dependencia\" disabled={!show} placeholder=\"Ingrese la dependencia\" name=\"dependencia\" type=\"text\" grid={{ xs: 7 }} validate={{\n                                required: { value: true, errorMessage: errorMessage },\n                            }} />\n                        </Col>\n                        <Col sm='2'>\n                            <Button className=\"btn btn-primary\" style={{ marginLeft: '8px' }} type=\"submit\">Crear</Button>\n                        </Col>\n                    </Row>\n                </AvForm>\n                <Modal isOpen={this.state.modal} toggle={this.toggleModal} >\n                    <div className=\"modal-header\">\n                        <h5 className=\"modal-title mt-0\" id=\"confirmacion\">¿Estas seguro de realizar esta acción?</h5>\n                        <button type=\"button\" onClick={() => this.setState({ modal: false })} className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                            <span aria-hidden=\"true\">&times;</span>\n                        </button>\n                    </div>\n                    <ModalFooter>\n                        <Button type=\"button\" color=\"secondary\" onClick={() => this.setState({ modal: false })} className=\"waves-effect\">Close</Button>\n                        <Button type=\"button\" color=\"primary\" className=\"waves-effect waves-light\" onClick={this.submitDependencia}>Confimar</Button>\n                    </ModalFooter>\n                </Modal>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default AddDependencia;"]},"metadata":{},"sourceType":"module"}